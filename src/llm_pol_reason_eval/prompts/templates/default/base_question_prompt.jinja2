{# 1. Składanie głównej instrukcji na podstawie flag z konfiguracji #}
{% if 'chain_of_thought' in components %}{% include '_components/instruction_cot.jinja2' %}{% else %}Proszę odpowiedzieć na poniższą serię pytań.{% endif %}
Po każdej kompletnej odpowiedzi umieść unikalny separator: '[[---KONIEC ODPOWIEDZI---]]'.

{# 2. Dołączanie przykładów "Few-Shot", jeśli zadeklarowano #}
{% if 'few_shot' in components and few_shot_path %}{% include few_shot_path %}{% endif %}
--- TERAZ TWOJA KOLEJ ---


{# 3. Renderowanie właściwych pytań z batcha #}
{% for q_id, q_data in questions.items() %}
========================================
### ZADANIE {{ loop.index }}

{% if q_data.get("context_ids") and contexts %}
### KONTEKST(Y)
{% for cid in q_data.get("context_ids", []) %}
{% if contexts.get(cid) %}
---
{{ contexts[cid].context_content }}
---
{% endif %}
{% endfor %}
{% endif %}

### POLECENIE
{{ q_data.question_text }}

{% if q_data.get("choices") %}
### OPCJE WYBORU
{% for choice in q_data.get("choices", []) %}
- {{ choice.choice_id }}: {{ choice.choice_text }}
{% endfor %}
{% endif %}
{% endfor %}

### ODPOWIEDZI
(Pamiętaj o umieszczeniu każdej odpowiedzi w tagach <answer>...</answer> i oddzieleniu ich separatorem '[[---KONIEC ODPOWIEDZI---]]')